<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/paper-styles.html">
<link rel="import" href="../../bower_components/paper-styles/shadow.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../bower_components/iron-autogrow-textarea/iron-autogrow-textarea.html">
<link rel="import" href="../../bower_components/vaadin-upload/vaadin-upload.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="notes-list.html">
<script type="text/javascript"> 
  var user;
</script>
<script type="text/javascript" src="user_data.js"></script>

<dom-module id="my-notes">
  <!-- Defines the element's style and local DOM -->
  <template>
    <style>
      :host {
        display: block;

        padding: 16px;
      }

      #header {
        position: relative;
        font-family: .SFNSText-Bold;
        left: 2.5%;
      }

      .buttonTitle {
        position: relative;
        text-align: center;
        bottom: 20px;
        font-family: .SFNSText-Bold;
        font-size: 20px;
        letter-spacing: 0;
      }

      #notesContainer {
        /* Rectangle 2: */
        position: relative;
        width: 95%;
        height: 400px;
        left: 2.5%;
        padding-left: 1%;
        padding-right: 1%;
        padding-top: 1%;
        background: #E9E9E9;
        border: 2px solid #9B9B9B;
        box-shadow: 1px 3px 4px 0 rgba(0,0,0,0.50);
        border-radius: 8px;
      }

      #buttonsContainer {
        position: relative;
        width: 95%;
        height: 40px;
        left: 2.5%;
        padding-top: 20px;
        padding-bottom:20px;
      }

      vaadin-upload.thick-border {
        --primary-color: #0266C8;
        --dark-primary-color: #063;
        --light-primary-color: #6c9;
        --error-color: darkred;

        background: #FFFFFF;
        border: 2px solid #9B9B9B;
        width: 95%;
        border-radius: 8px;
        font-family: .SFNSText-Bold;
        left: 1%;
        margin-left: 1%
        margin-right: 1%;
        margin-bottom: 1%;
      }

      vaadin-upload.thick-border[dragover] {
        border-color: #396;
     }

      #createMessageContainer {
        position: relative;
        width: 95%;
        left: 2.5%;
        margin-top: 20px;
        background: #E9E9E9;
        border: 1px solid #979797;
        box-shadow: 0 2px 4px 0 rgba(0,0,0,0.50);
        border-radius: 8px;
      }

      #textBox {
        background: #FFFFFF;
        border: 1px solid #979797;
        margin: 1%;
        width: 97%
      }

      #textButtons {
        position: relative;
        margin: 1%;
        height: 50px;
        width: 98%;
      }

      #messageType {
        width: 49%;
        height: 50px;
        margin-right: 1%;
      }

      #noteType {
        width: 49%;
        margin-right: 2%;
        background: #FFFFFF;
        border: 1px solid #979797;
        border-radius: 8px;
        text-align: center;
        font-family: .SFNSText-Bold;
        font-size: 20px;
        letter-spacing: 0;
      }

      #instructionType {
        width: 49%;
        background: #FFB5B5;
        border: 1px solid #979797;
        border-radius: 8px;
        text-align: center;
        font-family: .SFNSText-Bold;
        font-size: 20px;
        color: #FFFFFF;
        letter-spacing: 0;
      }

      #sendButton {
        width: 49%;
        height: 50px;
        background: #9BD977;
        border: 1px solid #979797;
        border-radius: 8px;
        font-family: .SFNSText-Bold;
        font-size: 20px;
        color: #FFFFFF;
        letter-spacing: 0;
        text-align: center;
      }

      #skypeButton {
        width: 98%;
        height: 50px;
        background: #1EB0ED;
        border: 1px solid #9B9B9B;
        box-shadow: 1px 3px 4px 0 rgba(0,0,0,0.50);
        border-radius: 8px;
        /* Switch to: */
        font-family: .SFNSText-Bold;
        font-size: 20px;
        color: #FFFFFF;
        letter-spacing: 0;
        text-align: center;
      }

      #filterButton {
        width: 98%;
        height: 50px;
        right: 0px;
        /* Rectangle 2: */
        background: #8FD567;
        border: 1px solid #9B9B9B;
        box-shadow: 1px 3px 4px 0 rgba(0,0,0,0.50);
        border-radius: 8px;
        /* Filter: All: */
        font-family: .SFNSText-Bold;
        font-size: 20px;
        color: #FFFFFF;
        letter-spacing: 0;
        text-align: center;
      }

      #endCall {
        position: relative;
        width: 95%;
        height: 50px;
        left: 2.5%;
        margin-top: 10px;
        /* Rectangle 2: */
        background: #FF4545;
        border: 1px solid #9B9B9B;
        box-shadow: 1px 3px 4px 0 rgba(0,0,0,0.50);
        border-radius: 8px;
        /* End Call: */
        font-family: .SFNSText-Bold;
        font-size: 20px;
        color: #FFFFFF;
        letter-spacing: 0;
      }

      #endCallText {
        position: relative; 
        text-align: center; 
        bottom: 30px
      }

      <style is="custom-style" include="iron-flex"></style>

    </style>

    <h1 id = "header"> Notepad </h1>

    <paper-card id = "notesContainer">
      
      <notes-list id = "notesList"></notes-list>
    </paper-card>

    <div id = "createMessageContainer">
    	<iron-autogrow-textarea id = "textBox">
	  	</iron-autogrow-textarea>
      <vaadin-upload id = photoUpload class="thick-border" max-files="1" target = "/static/images"></vaadin-upload>
      <div id = "textButtons" class = "layout horizontal">
        <paper-radio-group id = "messageType" selected="noteButton" class = "layout horizontal">
          <paper-radio-button name = "noteButton" id = "noteType"> Note </paper-radio-button>
          <paper-radio-button name = "instructionButton" id = "instructionType"> Instruction </paper-radio-button>
        </paper-radio-group>
        <paper-button id = "sendButton"> Send </paper-button>
      </div>
    </div>

    <div id = "buttonsContainer" class = "layout horizontal">
        <paper-button id = "skypeButton"> Switch to Skype</paper-button>
        <paper-button id = "filterButton"> Filter: All</paper-button>
    </div>

    <paper-button id = "endCall"> End Call </paper-button>

  </template>
  <!-- Creates the element's prototype and registers it -->
  <script>
    Polymer({
      is: 'my-notes',
      listeners: {
      	"sendButton.click": 'sendMessage',
      },

      sendMessage: function (){

        var messageType = "";
        var messageContent = "";
        var messageTitle = "";
        var shouldSend = false;
        var textInput = document.getElementById("textBox").value;
        document.getElementById("textBox").value = null;

        var photoInput = document.getElementById("photoUpload");

         if (photoInput.files.length != 0)
         {
          // Upload photo
            if (photoInput.files[0].complete)
            {
              // add to notesList and database
              messageType = "image";
              messageContent = photoInput.files[0].name;

              if (textInput != null)
              {
                messageTitle = textInput;
              }
              shouldSend = true;
            }

         }
         else
         {
           if (textInput != null)
            {
              var type = document.getElementById("messageType").selected;

              if (type = noteButton)
              {
                messageType = "note";
              }
              else
              {
                messageType = "instruction"
              }

              messageContent = textInput;
              shouldSend = true
            }
          
         }

         if (shouldSend)
         {
            document.getElementById("notesList").addMessage(false, messageType, messageContent, messageTitle, "");
            console.log("added message");
         }
        
      }
   		 

    });



  </script>
</dom-module>