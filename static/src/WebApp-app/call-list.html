<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../bower_components/iron-a11y-keys-behavior/iron-a11y-keys-behavior.html">
<link rel="import" href="../../bower_components/iron-scroll-target-behavior/iron-scroll-target-behavior.html">
<link rel="import" href="../../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<script type="text/javascript"> 
  var user;
</script>
<script type="text/javascript" src="user_data.js"></script>


<dom-module id="call-list">
  <!-- Defines the element's style and local DOM -->
  <template>
    <style>
      :host {
        display: flex;
        flex-direction: column;
      }

      .inactiveCall {
        width: 100%;
        padding-left: 10px;
        margin-bottom: 10px;
        background: #FFFFFF;
        border: 2px solid #9B9B9B;
        box-shadow: 1px 3px 4px 0 rgba(0,0,0,0.50);
        border-radius: 8px;
      }

      .activeCall {
        /* Rectangle 2: */
        position: relative;
        width: 100%;
        padding-left: 10px;
        margin-bottom: 10px;
        background: #A6DFA6;
        border: 2px solid #9B9B9B;
        box-shadow: 1px 3px 4px 0 rgba(0,0,0,0.50);
        border-radius: 8px;
      }

      .text {
        position: relative;
        width: 30%;
        text-align: center;
      }

      :host {
        display: flex;
        height: 620px;
        flex-direction: column-reverse;
        align-items: space-around;
      }
      
      iron-list {
       
      }

      .ironList #items.iron-list{
        padding: 10px;
        margin: 10;
        position: relative;
        top: 20;
        will-change: transform;
      }
        
}

    </style>

  <iron-list id ='ironList' class ='ironList' items="[[user.callList]]" style="height:100%;width:100%">
    <template style="height:100%;width:100%">
    <div>

      <template is="dom-if" if="{{isDoctor(item)}}">
      <div>
        <template is="dom-if" if="{{isActive(item)}}">

          <paper-card id = "log{{item.call_id}}" class = "activeCall">
            <div id = callContainer class = "layout horizontal">
              <h5 class = "text"> {{fullName(item.emt_id)}} </h5>
              <h5 class = "text"> {{item.date}} </h5>
              <h5 class = "text"> Active </h5>
            </div>
          </paper-card>

        </template>

        <template is="dom-if" if="{{isNotActive(item)}}">

          <paper-card id = "log{{item.call_id}}" class = "inactiveCall">
            <div id = callContainer class = "layout horizontal">
              <h5 class = "text"> {{fullName(item.emt_id)}} </h5>
              <h5 class = "text"> {{item.date}} </h5>
              <h5 class = "text"> {{item.call_length}} </h5>
            </div>
          </paper-card>
         </template>
        </div>
       </template>

       <template is="dom-if" if="{{isEMT(item)}}">
       <div>
        <template is="dom-if" if="{{isActive(item)}}">

          <paper-card id = "log{{item.call_id}}" class = "activeCall">
            <div id = callContainer class = "layout horizontal">
              <h5 class = "text"> {{fullName(item.dr_id)}} </h5>
              <h5 class = "text"> {{item.date}} </h5>
              <h5 class = "text"> Active </h5>
            </div>
          </paper-card>

        </template>

        <template is="dom-if" if="{{isNotActive(item)}}">

          <paper-card id = "log{{item.call_id}}" class = "inactiveCall">
            <div id = callContainer class = "layout horizontal">
              <h5 class = "text"> {{fullName(item.dr_id)}} </h5>
              <h5 class = "text"> {{item.date}} </h5>
              <h5 class = "text"> {{item.call_length}} </h5>
            </div>
          </paper-card>
         </template>
        </div>
       </template>


      </div>

      </template>

    </iron-list>

  </template>
  <!-- Creates the element's prototype and registers it -->
  <script>

    Polymer({
      is: 'call-list',
      ready: function() {
        this.callList = [
            {
              call_id: 0, 
              dr_id: [0,0,0,"Colin", "Lockareff"],
              emt_id: [0,0,0,"Garrett", "Zelin"], 
              date: "4-17-2017 8:35", 
              call_length: "25:20", 
              is_active: 1, 
            },
            {
              call_id: 1, 
              dr_id: [0,0,0,"Kayla", "Fedewa"],
              emt_id: [0,0,0,"Matt", "Fox"], 
              date: "4-13-2017 14:00", 
              call_length: "10:20", 
              is_active: 0, 
            },
            {
              call_id: 2, 
              emt_id: [0,0,0,"Colin", "Lockareff"],
              dr_id: [0,0,0,"Garrett", "Zelin"], 
              date: "3-29-2017 3:35", 
              call_length: "13:12", 
              is_active: 0,  
            },
            {
              call_id: 3, 
              emt_id: [0,0,0,"Kayla", "Fedewa"],
              dr_id: [0,0,0,"Matt", "Fox"], 
              date: "3-28-2017 18:39 ", 
              call_length: "9:43", 
              is_active: 0,  
            },
        ];
      },

      isActive: function(item){
        console.log('In an iff');
        console.log(item);
        return item.is_active == 1;
      },
      isNotActive: function(item){
        console.log('In an iff');
        console.log(item);
        return item.is_active == 0;
      },
      isDoctor: function(item){
        console.log('In an iff');
        console.log(user.type);
        return user.type == "dr";
      },
      isEMT: function(item){
        console.log('In an iff');
        console.log(user.type);
        return user.type == "emt";
      },

      fullName: function(item){
        return item[3] + " " + item[4];
      }


})
  </script>
</dom-module>